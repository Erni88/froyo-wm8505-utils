#include <stdio.h>
#include <fcntl.h>
#include <sys/ioctl.h>

main(){
	printf("Loading Touchscreen Calibration Data...\n");
	int fd;
	fd = open("/dev/touchscreen", 2);
	if(fd < 0){printf("ERROR: Touchscreen device not found, is the module loaded?\n");}
        FILE *fr;
        fr = fopen ("/etc/touchcal", "rt");
	if(fr == 0){printf("ERROR: Calibration file not found at /etc/touchcal\n");}
        char line[80];
        fgets(line, 80, fr);
        fclose(fr);
        char substr[4], *ptr = line;
        int data[7];
        int n;
        int count=0;
        while ( *ptr ){
                        sscanf(ptr, "%31[^ ]%n", substr, &n);
                        ptr += n;
                        data[count]=atoi(substr);
                        ++ptr;
                        count++;
        }
	ioctl(fd, 0x40047402u, data);
}
